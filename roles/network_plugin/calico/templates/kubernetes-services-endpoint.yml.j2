---
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: kube-system
  name: kubernetes-services-endpoint
data:
{% if calico_bpf_enabled or loadbalancer_apiserver_localhost %}
{% if loadbalancer_apiserver_localhost %}
  KUBERNETES_SERVICE_HOST: "127.0.0.1"
  KUBERNETES_SERVICE_PORT: "{{ loadbalancer_apiserver_port | default(kube_apiserver_port) }}"
{% else %}
  KUBERNETES_SERVICE_HOST: "{{ kube_apiserver_global_endpoint | urlsplit('hostname') }}"
  KUBERNETES_SERVICE_PORT: "{{ kube_apiserver_global_endpoint | urlsplit('port') }}"
{% endif %}
{% endif %}
