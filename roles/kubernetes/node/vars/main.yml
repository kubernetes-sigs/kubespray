---
# Those vars are designed to convert a systemd slice ('some-slice.slice')
# to the matching cgroup under /sys/fs/cgroup ('/some.slice/some-slice.slice')
kube_slice_cgroup: "{{ ('/' + ((kube_slice | splitext)[0].split('-') | map('split')
                        | community.general.accumulate | map('join', '-') | join('.slice/') + 'slice/'))
                      if kubelet_cgroup_driver == 'cgroupfs' else kube_slice }}/"
system_slice_cgroup: "{{ ('/' + ((system_slice | splitext)[0].split('-') | map('split')
                        | community.general.accumulate | map('join', '-') | join('.slice/') + 'slice/'))
                      if kubelet_cgroup_driver == 'cgroupfs' else system_slice }}/"
enforce_node_allocatable_stub:
  pods: "{{ enforce_allocatable_pods }}"
  kube-reserved: "{{ enforce_allocatable_kube_reserved }}"
  system-reserved: "{{ enforce_allocatable_system_reserved }}"
enforce_node_allocatable: "{{ enforce_node_allocatable_stub | dict2items | selectattr('value') | map(attribute='key') }}"
