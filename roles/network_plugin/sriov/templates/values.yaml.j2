#jinja2: trim_blocks: True, lstrip_blocks: True
operator:
  tolerations:
    {{ sriov_operator_tolerations | to_nice_yaml(indent=2) | indent(4) }}
  affinity:
    nodeAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 1
          preference:
            matchExpressions:
              - key: node-role.kubernetes.io/control-plane
                operator: In
                values: [""]
{% if sriov_operator_resources is defined %}
  resources:
    {{ sriov_operator_resources | to_nice_yaml(indent=2) | indent(4) }}
{% endif %}
  resourcePrefix: {{ sriov_operator_resource_prefix }}
  cniBinPath: {{ sriov_cni_bin_dir }}
  clusterType: {{ sriov_operator_cluster_type }}
  admissionControllers:
    enabled: {{ sriov_operator_enable_admission_controller | to_json }}
  metricsExporter:
    port: "{{ sriov_metrics_exporter_port }}"
{% if sriov_operator_enable_prometheus %}
    prometheusOperator:
      enabled: true
{% endif %}

sriovOperatorConfig:
  deploy: true
  logLevel: {{ sriov_operator_log_level }}
  disableDrain: {{ sriov_operator_disable_drain | to_json }}
  configurationMode: {{ sriov_operator_configuration_mode }}
{% if sriov_operator_disable_plugins | length > 0 %}
  disablePlugins: {{ sriov_operator_disable_plugins | to_json }}
{% endif %}

images:
  operator: "{{ sriov_operator_image_repo }}:{{ sriov_operator_image_tag }}"
  sriovConfigDaemon: "{{ sriov_config_daemon_image_repo }}:{{ sriov_config_daemon_image_tag }}"
  sriovCni: "{{ sriov_cni_image_repo }}:{{ sriov_cni_image_tag }}"
  ibSriovCni: "{{ sriov_ib_cni_image_repo }}:{{ sriov_ib_cni_image_tag }}"
  ovsCni: "{{ sriov_ovs_cni_image_repo }}:{{ sriov_ovs_cni_image_tag }}"
  rdmaCni: "{{ sriov_rdma_cni_image_repo }}:{{ sriov_rdma_cni_image_tag }}"
  sriovDevicePlugin: "{{ sriov_device_plugin_image_repo }}:{{ sriov_device_plugin_image_tag }}"
  resourcesInjector: "{{ sriov_resources_injector_image_repo }}:{{ sriov_resources_injector_image_tag }}"
  webhook: "{{ sriov_webhook_image_repo }}:{{ sriov_webhook_image_tag }}"
  metricsExporter: "{{ sriov_metrics_exporter_image_repo }}:{{ sriov_metrics_exporter_image_tag }}"
  metricsExporterKubeRbacProxy: "{{ sriov_kube_rbac_proxy_image_repo }}:{{ sriov_kube_rbac_proxy_image_tag }}"
